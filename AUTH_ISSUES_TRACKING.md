# 认证系统问题追踪文档
**创建时间**: 2025-08-06  
**状态**: 待修复

## 🚨 发现的问题

### 1. 数据库迁移超时 ⏳
- **问题**: Railway迁移端点超时，新的用户认证表未创建
- **影响**: Sign In功能无法使用，会显示数据库错误
- **状态**: 进行中
- **解决方案**: 简化迁移脚本或使用替代方法

### 2. Checkout页面Sign In界面不显示 🔴
- **问题**: 点击"Sign In"选项后不显示邮箱密码输入框
- **现象**: Guest和Create Account都正常显示contact information，但Sign In没有显示signin-section
- **可能原因**: JavaScript初始化问题或CSS display问题
- **状态**: 待修复

### 3. 网站右上角认证按钮无作用 🔴  
- **问题**: 主页/菜单页右上角的"Sign In"和"Register"按钮点击无反应
- **位置**: 网站header部分
- **状态**: 待修复
- **需要检查**: 按钮href链接和事件处理

## 🔧 修复计划

### Phase 1: 数据库迁移修复
1. ✅ 检查当前迁移脚本复杂度
2. ⏳ 简化迁移脚本，移除复杂操作
3. ⏳ 创建最小化认证表结构
4. ⏳ 重新部署和测试迁移

### Phase 2: 前端Sign In界面修复  
1. ⏳ 检查checkout.html的JavaScript初始化逻辑
2. ⏳ 验证toggleAuthSections方法执行
3. ⏳ 检查signin-section的CSS display属性
4. ⏳ 测试三种认证模式切换
5. ⏳ 本地测试验证修复效果

### Phase 3: Header认证按钮修复
1. ⏳ 检查index.html和menu.html的Sign In/Register按钮
2. ⏳ 添加正确的链接或JavaScript事件处理
3. ⏳ 确保按钮导向checkout.html并预选相应认证模式
4. ⏳ 测试所有页面的认证按钮功能

### Phase 4: 完整系统测试
1. ⏳ 端到端认证流程测试
2. ⏳ 所有页面认证功能验证
3. ⏳ 移动端响应式测试
4. ⏳ 错误处理和用户体验测试

## 📋 测试清单

### 数据库测试
- [ ] 迁移成功执行
- [ ] 用户表和地址表创建
- [ ] 测试用户数据插入成功
- [ ] API认证端点正常工作

### 前端界面测试  
- [ ] Checkout页面三个认证选项正确显示
- [ ] Sign In选择显示邮箱密码输入框
- [ ] Guest选择显示contact information表单
- [ ] Create Account选择显示contact + password表单
- [ ] 认证模式切换正常工作

### 认证按钮测试
- [ ] 主页右上角Sign In按钮工作
- [ ] 主页右上角Register按钮工作  
- [ ] 菜单页认证按钮工作
- [ ] 按钮正确导向checkout页面

### 完整流程测试
- [ ] 用户注册流程完整可用
- [ ] 用户登录流程完整可用
- [ ] Guest下单流程不受影响
- [ ] 所有认证状态下订单提交正常

## 📝 修复记录

### 2025-08-06
- **创建问题追踪文档**
- **开始Phase 1: 数据库迁移修复**

---

**下一步**: 开始修复数据库迁移超时问题